-- Database: great_toronto_area

DROP DATABASE great_toronto_area

CREATE DATABASE great_toronto_area
    WITH 
    OWNER = postgres
    ENCODING = 'UTF8'
    LC_COLLATE = 'en_US.UTF-8'
    LC_CTYPE = 'en_US.UTF-8'
    TABLESPACE = pg_default
    CONNECTION LIMIT = -1;
	
SELECT * FROM public."GTA"

-- create separate columns for address, city, province
SELECT  "Address", split_part("Address", '|', 1) as address, split_part(split_part("Address", '|', 2), ',',1) as city, split_part(split_part("Address", '|', 2),',', 2) as province
FROM public."GTA"

ALTER TABLE "GTA"
ADD COLUMN address text

UPDATE public."GTA"
SET address = split_part("Address", '|', 1)

ALTER TABLE "GTA"
ADD COLUMN city text

UPDATE public."GTA"
SET city = split_part(split_part("Address", '|', 2), ',',1)

ALTER TABLE "GTA"
ADD COLUMN province text

UPDATE public."GTA"
SET province = split_part(split_part("Address", '|', 2),',', 2)

ALTER TABLE "GTA"
DROP COLUMN "Address"

--- remove index column

ALTER TABLE "GTA"
DROP COLUMN "index"


--- store only the first number for bedrooms


--- create total room column


--- store only digits for price



--- check null values

--- remove data that does not have value for city

--- group by city, room, 







ALTER TABLE "GTA" 
    ALTER COLUMN "bedrooms" TYPE INT,
    ALTER COLUMN "price" TYPE price;



